# Fluent Bit Parsers Configuration

# RFC 3164 Syslog (traditional format)
# Example: <34>Oct 11 22:14:15 mymachine su: 'su root' failed
[PARSER]
    Name         syslog-rfc3164
    Format       regex
    Regex        ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key     time
    Time_Format  %b %d %H:%M:%S
    Time_Keep    On

# RFC 5424 Syslog (modern format)
# Example: <165>1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut="3"] An application event log entry
[PARSER]
    Name         syslog-rfc5424
    Format       regex
    Regex        ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[^ ]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*?)\]|-)+) (?<message>.+)$
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep    On

# Generic syslog (fallback)
[PARSER]
    Name         syslog-generic
    Format       regex
    Regex        ^(?<message>.*)$

# JSON parser for structured logs
[PARSER]
    Name         json
    Format       json
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep    On
